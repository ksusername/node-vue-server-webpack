webpackJsonp([1],[,,,,,,,function(o,t,e){"use strict";function i(o){return o&&o.__esModule?o:{"default":o}}Object.defineProperty(t,"__esModule",{value:!0});var s=e(2),n=i(s),a=e(8),c=i(a);e(9);var l=e(10),r=i(l),d=e(11),u=i(d),f=e(13),m=i(f),k=n["default"].extend({template:c["default"],ready:function(){var o=this,t=!1;$(".infinite-scroll-bottom").on("infinite",function(){t||(t=!0,m["default"].getCookbookList(o.id,o.page).then(function(e){o.page+=1;for(var i=0;i<=e.tngou.length;i++)e.tngou[i]&&o.cookbookItems.push(e.tngou[i]);-1==o.maxItems&&(o.maxItems=e.total),t=!1})["catch"](function(){console.error("出错啦")})["finally"](function(){o.isShowLoad||($.detachInfiniteScroll($(".infinite-scroll")),$(".infinite-scroll-preloader").remove())}))}),$(".pull-to-refresh-content").on("refresh",function(){t||(t=!0,o.page=1,m["default"].getCookbookList(o.id,o.page).then(function(e){o.page+=1,o.updateTime=(new Date).getTime(),o.cookbookItems=e.tngou,o.maxItems>0&&(o.maxItems=e.total),t=!1,$.pullToRefreshDone(".pull-to-refresh-content")})["catch"](function(){console.error("出错啦"),$.pullToRefreshDone(".pull-to-refresh-content")}))}),$.init(),setTimeout(function(){o.scrollTabBtn(o.id)},300)},data:function(){return r["default"]},methods:{goCookbook:function(o){this.$router.go("/cookbook/"+o),this.scrollTabBtn(o)},goCookbookDetail:function(o){this.$router.go("/cookbookDetail/"+o)},goBack:function(){this.$router.go("/cookbook/1")},goRoute:function(o){$("body").removeClass("with-panel-left-reveal"),this.$router.go(o)},openPanel:function(o){$.openPanel("#"+o)},scrollTabBtn:function(o){var t=o,e=$(".button.class_"+t),i=e[0];if(0!=e.length){var s=i.offsetLeft-i.parentNode.offsetLeft,n=$("#class_tab")?$("#class_tab")[0].scrollLeft:0;if($.device.android&&$.device.isWeixin)$("#class_tab").scrollLeft(s-50);else if(0>n-s)for(var a=function(o){!function(){setTimeout(function(){$("#class_tab").scrollLeft(Math.abs(n+(s-n)/50*o)-o)},5*o)}()},c=0;50>c;c++)a(c);else for(var l=function(o){!function(){setTimeout(function(){$("#class_tab").scrollLeft(s-(n-s)/50*o-o)},5*o)}()},r=0;50>r;r++)l(r)}}},computed:{isShowLoad:function(){return!this.maxItems||!this.cookbookItems||this.maxItems>this.cookbookItems.length}},route:{data:function(o){var t=this;this.title="菜谱列表","string"==typeof localStorage.getItem("cookbook_classes")&&(this.cookbookClasses=JSON.parse(localStorage.getItem("cookbook_classes"))),window.cm_cookbookItems&&window.cm_cookbookItems.id==o.to.params.id&&(console.log("应该只进入一次"),this.$data=window.cm_cookbookItems,$.localStorage.setItem("cookbook_list_"+o.to.params.id,{id:o.to.params.id,updateTime:(new Date).getTime(),page:2,cookbookItems:window.cm_cookbookItems.cookbookItems,maxItems:window.cm_cookbookItems.maxItems}),window.cm_cookbookItems=null);var e=$.localStorage.getItem("cookbook_list_"+o.to.params.id);this.id==o.to.params.id?setTimeout(function(){$(".content").scrollTop(t.scrollTop)}):e&&e.cookbookItems.length>=10?(this.id=e.id,this.page=e.page,this.cookbookItems=e.cookbookItems,this.maxItems=e.maxItems,this.updateTime=e.updateTime):!function(){$.showIndicator();var e=o.to.params.id,i=[m["default"].getCookbookList(e,1)];"string"!=typeof localStorage.getItem("cookbook_classes")&&i.push(m["default"].getCookbookClass()),u["default"].all(i).then(function(i){var s=i[0];s.status?(t.id=e,t.page=2,t.cookbookItems=s.tngou,t.maxItems=s.total):o.abort(),i.length>1&&(t.cookbookClasses=i[1].tngou)})["catch"](function(o){$.toast("操作失败")})["finally"](function(){$.hideIndicator()}),o.next()}()},canReuse:!0,activate:function(o){var t=this;window.cm_cookbookItems&&(this.cookbookClasses=window.cm_cookbookItems.cookbookClasses),!this.cookbookClasses.length>0&&m["default"].getCookbookClass().then(function(o){o.length>0&&(t.cookbookClasses=o.tngou)}),o.next()},deactivate:function(o){o.next()}}});t["default"]=k},function(o,t){o.exports='<div class="page page-current">\n    <!-- 标题栏 -->\n    <header class="bar bar-nav">\n        <h1 class="title">菜谱demo</h1>\n    </header>\n\n    <!--2级标题栏-->\n    <div class="bar bar-header-secondary" id="class_tab">\n        <a v-for="item in cookbookClasses" @click="goCookbook(item.id)"\n           class="button class_{{item.id}} {{item.id == id?\'active\':\'\'}}"\n        >{{item.title}}</a>\n    </div>\n\n\n    <div class="content infinite-scroll infinite-scroll-bottom pull-to-refresh-content"  data-ptr-distance="70" >\n        <!-- 默认的下拉刷新层 -->\n        <div class="pull-to-refresh-layer">\n            <div class="preloader"></div>\n            <div class="pull-to-refresh-arrow"></div>\n            <div style="position:absolute;bottom:-3px;width:100%;text-align: center;font-size: 12px;">{{updateTime | time-diff}}前更新过</div>\n        </div>\n\n        <div class="">\n            <!-- 这里是页面内容区 -->\n            <div class="cookbook-box" id="cookbook_{{id}}">\n                <div class="card" v-for="item in cookbookItems" @click="goCookbookDetail(item.id)">\n                    <div class="card-content">\n                        <div class="list-block media-list">\n                            <ul>\n                                <li class="item-content">\n                                    <div class="item-media">\n                                        <img :src="\'http://tnfs.tngou.net/img\'+item.img" width="44">\n                                    </div>\n                                    <div class="item-inner">\n                                        <div class="item-title-row">\n                                            <div class="item-title">{{item.name}}</div>\n                                        </div>\n                                        <div class="item-subtitle">{{item.food}}</div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n                <!-- 加载提示符 -->\n                <div class="infinite-scroll-preloader" v-if="isShowLoad">\n                    <div class="preloader"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n</div>'},function(o,t){},function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e={cookbookClasses:[],id:0,page:1,title:"菜谱列表",cookbookItems:[],maxItems:-1,updateTime:"",valOptions:[]};t["default"]=e},,,function(o,t,e){"use strict";function i(o){return o&&o.__esModule?o:{"default":o}}function s(o,t){return l["default"].Promise(function(e,i){$.ajax({type:"GET",url:"http://apis.baidu.com/tngou/cook/list",data:{id:o,page:t},headers:{apikey:"a369f43a6392605426433831e10765ec"},success:function(s){if(s.status){if(1==t)localStorage.setItem("cookbook_list_"+o,JSON.stringify({id:o,updateTime:(new Date).getTime(),page:2,cookbookItems:s.tngou,maxItems:s.total}));else{for(var n=JSON.parse(localStorage.getItem("cookbook_list_"+o)),a=0;a<s.tngou.length;a++)n.cookbookItems.push(s.tngou[a]);n.page=++t,n.maxItems=s.total,localStorage.setItem("cookbook_list_"+o,JSON.stringify(n))}e(s)}else i("请求失败")},error:function(o){i("请求失败")}})})}function n(){return l["default"].Promise(function(o,t){var e=$.localStorage.getItem("cookbook_classes");e?o(e):$.ajax({type:"GET",url:"http://apis.baidu.com/tngou/cook/classify",data:{id:0},headers:{apikey:"a369f43a6392605426433831e10765ec"},success:function(e){e.status?(localStorage.setItem("cookbook_classes",JSON.stringify(e.tngou)),o(e)):t("请求失败!")},error:function(o,e){t("请求失败")}})})}function a(o){return l["default"].Promise(function(t,e){$.ajax({type:"GET",url:"http://apis.baidu.com/tngou/cook/show",data:{id:o},headers:{apikey:"a369f43a6392605426433831e10765ec"},success:function(o){o.status?t(o):e("请求失败")},error:function(o,t){e("请求失败")}})})}Object.defineProperty(t,"__esModule",{value:!0});var c=e(11),l=i(c),r={getCookbookList:s,getCookbookClass:n,getCookbookDetail:a};t["default"]=r}]);
//# sourceMappingURL=1.0ce212e3.js.map