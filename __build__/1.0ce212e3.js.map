{"version":3,"sources":["webpack:///1.0ce212e3.js","webpack:///./client/com.chezhil.cookbook/states/cookbook-list/route.js","webpack:///./client/com.chezhil.cookbook/states/cookbook-list/template.html","webpack:///./client/com.chezhil.cookbook/states/cookbook-list/value.js","webpack:///./client/com.chezhil.cookbook/service/cookbook.service.js"],"names":["webpackJsonp","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_vue","_vue2","_template","_template2","_value","_value2","_q","_q2","_cookbook","_cookbook2","Index","extend","template","ready","_this","this","loading","$","on","getCookbookList","id","page","then","data","i","tngou","length","cookbookItems","push","maxItems","total","console","error","isShowLoad","detachInfiniteScroll","remove","updateTime","Date","getTime","pullToRefreshDone","init","setTimeout","scrollTabBtn","methods","goCookbook","$router","go","goCookbookDetail","goBack","goRoute","route","removeClass","openPanel","panel_id","class_id","$el","el","scrollLeft","offsetLeft","parentNode","scrollLeft_active","device","android","isWeixin","_loop","Math","abs","_loop2","_i","computed","transition","_this2","title","localStorage","getItem","cookbookClasses","JSON","parse","window","cm_cookbookItems","to","params","log","$data","setItem","cookbook","scrollTop","showIndicator","qa_id","promise","getCookbookClass","all","data0","status","abort","e","toast","hideIndicator","next","canReuse","activate","_this3","deactivate","valOptions","Promise","_success","_error","ajax","type","url","headers","apikey","success","response","stringify","oldValue","xhr","_success2","_error2","classes","errorType","getCookbookDetail","_success3","_error3","cookbookService"],"mappings":"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","file":"1.0ce212e3.js","sourcesContent":["webpackJsonp([1],[\n/* 0 */,\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */,\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _vue = __webpack_require__(2);\n\t\n\tvar _vue2 = _interopRequireDefault(_vue);\n\t\n\tvar _template = __webpack_require__(8);\n\t\n\tvar _template2 = _interopRequireDefault(_template);\n\t\n\t__webpack_require__(9);\n\t\n\tvar _value = __webpack_require__(10);\n\t\n\tvar _value2 = _interopRequireDefault(_value);\n\t\n\tvar _q = __webpack_require__(11);\n\t\n\tvar _q2 = _interopRequireDefault(_q);\n\t\n\tvar _cookbook = __webpack_require__(13);\n\t\n\tvar _cookbook2 = _interopRequireDefault(_cookbook);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar Index = _vue2.default.extend({\n\t    //replace : true, //必须注释掉 不然动画失效\n\t    template: _template2.default,\n\t    ready: function ready() {\n\t        var _this = this;\n\t\n\t        //做浏览器判断 和 兼容\n\t        var loading = false;\n\t        //$('#class_tab').attr('data-offset',$('header.bar.bar-nav')[0].offsetHeight-1)\n\t        //绑定无限滚动事件\n\t        $('.infinite-scroll-bottom').on('infinite', function () {\n\t            if (loading) {\n\t                return;\n\t            }\n\t            loading = true;\n\t\n\t            _cookbook2.default.getCookbookList(_this.id, _this.page).then(function (data) {\n\t                _this.page += 1;\n\t                for (var i = 0; i <= data.tngou.length; i++) {\n\t                    if (data.tngou[i]) {\n\t                        _this.cookbookItems.push(data.tngou[i]);\n\t                    }\n\t                }\n\t                if (_this.maxItems == -1) {\n\t                    _this.maxItems = data.total;\n\t                }\n\t                loading = false;\n\t            }).catch(function () {\n\t                console.error('出错啦');\n\t            }).finally(function () {\n\t                if (!_this.isShowLoad) {\n\t                    //解绑无限加载事件\n\t                    $.detachInfiniteScroll($('.infinite-scroll'));\n\t                    // 删除加载提示符\n\t                    $('.infinite-scroll-preloader').remove();\n\t                }\n\t            });\n\t        });\n\t\n\t        //绑定下拉刷新事件\n\t        $('.pull-to-refresh-content').on('refresh', function () {\n\t            if (loading) {\n\t                return;\n\t            }\n\t            loading = true;\n\t\n\t            _this.page = 1;\n\t            _cookbook2.default.getCookbookList(_this.id, _this.page).then(function (data) {\n\t                _this.page += 1;\n\t                _this.updateTime = new Date().getTime();\n\t                _this.cookbookItems = data.tngou;\n\t                if (_this.maxItems > 0) {\n\t                    _this.maxItems = data.total;\n\t                }\n\t                loading = false;\n\t                // 加载完毕需要重置\n\t                $.pullToRefreshDone('.pull-to-refresh-content');\n\t            }).catch(function () {\n\t                console.error('出错啦');\n\t                //加载完毕需要重置\n\t                $.pullToRefreshDone('.pull-to-refresh-content');\n\t            });\n\t        });\n\t\n\t        //需要初始化一下,不然监听不到infinite事件\n\t        $.init();\n\t\n\t        setTimeout(function () {\n\t            _this.scrollTabBtn(_this.id);\n\t        }, 3e2);\n\t    },\n\t    data: function data() {\n\t        return _value2.default;\n\t    },\n\t    methods: {\n\t        goCookbook: function goCookbook(id) {\n\t            this.$router.go('/cookbook/' + id);\n\t            this.scrollTabBtn(id);\n\t        },\n\t        goCookbookDetail: function goCookbookDetail(id) {\n\t            this.$router.go('/cookbookDetail/' + id);\n\t        },\n\t        goBack: function goBack() {\n\t            this.$router.go('/cookbook/1');\n\t        },\n\t        goRoute: function goRoute(route) {\n\t            //$.closePanel();\n\t            $('body').removeClass('with-panel-left-reveal');\n\t            //setTimeout(()=>{\n\t            this.$router.go(route);\n\t            //},5e2)\n\t        },\n\t        openPanel: function openPanel(panel_id) {\n\t            $.openPanel('#' + panel_id);\n\t        },\n\t        scrollTabBtn: function scrollTabBtn(id) {\n\t            var class_id = id;\n\t            var $el = $('.button.class_' + class_id);\n\t            var el = $el[0];\n\t            if ($el.length == 0) {\n\t                return;\n\t            }\n\t\n\t            var scrollLeft = el.offsetLeft - el.parentNode.offsetLeft;\n\t            var scrollLeft_active = $('#class_tab') ? $('#class_tab')[0].scrollLeft : 0;\n\t\n\t            if ($.device.android && $.device.isWeixin) {\n\t                $('#class_tab').scrollLeft(scrollLeft - 50);\n\t            } else {\n\t                if (scrollLeft_active - scrollLeft < 0) {\n\t                    var _loop = function _loop(i) {\n\t                        (function () {\n\t                            setTimeout(function () {\n\t                                $('#class_tab').scrollLeft(Math.abs(scrollLeft_active + (scrollLeft - scrollLeft_active) / 50 * i) - i);\n\t                            }, 5 * i);\n\t                        })();\n\t                    };\n\t\n\t                    for (var i = 0; i < 50; i++) {\n\t                        _loop(i);\n\t                    }\n\t                } else {\n\t                    var _loop2 = function _loop2(_i) {\n\t                        (function () {\n\t                            setTimeout(function () {\n\t                                $('#class_tab').scrollLeft(scrollLeft - (scrollLeft_active - scrollLeft) / 50 * _i - _i);\n\t                            }, 5 * _i);\n\t                        })();\n\t                    };\n\t\n\t                    for (var _i = 0; _i < 50; _i++) {\n\t                        _loop2(_i);\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    },\n\t    computed: {\n\t        isShowLoad: function isShowLoad() {\n\t            return !this.maxItems || !this.cookbookItems || this.maxItems > this.cookbookItems.length;\n\t        }\n\t    },\n\t    route: {\n\t        data: function data(transition) {\n\t            var _this2 = this;\n\t\n\t            this.title = '菜谱列表';\n\t\n\t            if (typeof localStorage.getItem('cookbook_classes') == 'string') {\n\t                this.cookbookClasses = JSON.parse(localStorage.getItem('cookbook_classes'));\n\t            }\n\t            //如果是服务端渲染的,应该设置全局变量,那么客户端就不用异步请求数据了\n\t            if (window.cm_cookbookItems && window.cm_cookbookItems.id == transition.to.params.id) {\n\t                console.log('应该只进入一次');\n\t                this.$data = window.cm_cookbookItems;\n\t                $.localStorage.setItem('cookbook_list_' + transition.to.params.id, {\n\t                    id: transition.to.params.id,\n\t                    updateTime: new Date().getTime(),\n\t                    page: 2,\n\t                    cookbookItems: window.cm_cookbookItems.cookbookItems,\n\t                    maxItems: window.cm_cookbookItems.maxItems\n\t                });\n\t                window.cm_cookbookItems = null;\n\t            }\n\t            var cookbook = $.localStorage.getItem('cookbook_list_' + transition.to.params.id);\n\t            //缓存里面还有数据\n\t            if (this.id == transition.to.params.id) {\n\t                setTimeout(function () {\n\t                    $('.content').scrollTop(_this2.scrollTop);\n\t                });\n\t            } else if (cookbook && cookbook.cookbookItems.length >= 10) {\n\t                //本地如果有数据的话拿本地数据\n\t                this.id = cookbook.id;\n\t                this.page = cookbook.page;\n\t                this.cookbookItems = cookbook.cookbookItems;\n\t                this.maxItems = cookbook.maxItems;\n\t                this.updateTime = cookbook.updateTime;\n\t            } else {\n\t                (function () {\n\t                    $.showIndicator();\n\t                    //没有本地数据再去请求数据\n\t                    var qa_id = transition.to.params.id;\n\t\n\t                    var promise = [_cookbook2.default.getCookbookList(qa_id, 1)];\n\t                    if (typeof localStorage.getItem('cookbook_classes') != 'string') {\n\t                        promise.push(_cookbook2.default.getCookbookClass());\n\t                    }\n\t\n\t                    _q2.default.all(promise).then(function (data) {\n\t                        var data0 = data[0];\n\t                        if (data0.status) {\n\t                            _this2.id = qa_id;\n\t                            _this2.page = 2;\n\t                            _this2.cookbookItems = data0.tngou;\n\t                            _this2.maxItems = data0.total;\n\t                        } else {\n\t                            transition.abort();\n\t                        }\n\t                        if (data.length > 1) {\n\t                            _this2.cookbookClasses = data[1].tngou;\n\t                        }\n\t                    }).catch(function (e) {\n\t                        $.toast(\"操作失败\");\n\t                    }).finally(function () {\n\t                        $.hideIndicator();\n\t                    });\n\t\n\t                    transition.next();\n\t                })();\n\t            }\n\t        },\n\t        canReuse: true, //可以被重用,跳转到其他cookbook/? 页面时触发. 设置为True跳转失败会无限跳转\n\t        activate: function activate(transition) {\n\t            var _this3 = this;\n\t\n\t            if (window.cm_cookbookItems) {\n\t                this.cookbookClasses = window.cm_cookbookItems.cookbookClasses;\n\t            }\n\t            if (!this.cookbookClasses.length > 0) {\n\t                _cookbook2.default.getCookbookClass().then(function (data) {\n\t                    if (data.length > 0) {\n\t                        _this3.cookbookClasses = data.tngou;\n\t                    }\n\t                });\n\t            }\n\t            transition.next();\n\t        },\n\t        deactivate: function deactivate(transition) {\n\t            transition.next();\n\t        }\n\t    }\n\t});\n\t\n\texports.default = Index;\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"page page-current\\\">\\n    <!-- 标题栏 -->\\n    <header class=\\\"bar bar-nav\\\">\\n        <h1 class=\\\"title\\\">菜谱demo</h1>\\n    </header>\\n\\n    <!--2级标题栏-->\\n    <div class=\\\"bar bar-header-secondary\\\" id=\\\"class_tab\\\">\\n        <a v-for=\\\"item in cookbookClasses\\\" @click=\\\"goCookbook(item.id)\\\"\\n           class=\\\"button class_{{item.id}} {{item.id == id?'active':''}}\\\"\\n        >{{item.title}}</a>\\n    </div>\\n\\n\\n    <div class=\\\"content infinite-scroll infinite-scroll-bottom pull-to-refresh-content\\\"  data-ptr-distance=\\\"70\\\" >\\n        <!-- 默认的下拉刷新层 -->\\n        <div class=\\\"pull-to-refresh-layer\\\">\\n            <div class=\\\"preloader\\\"></div>\\n            <div class=\\\"pull-to-refresh-arrow\\\"></div>\\n            <div style=\\\"position:absolute;bottom:-3px;width:100%;text-align: center;font-size: 12px;\\\">{{updateTime | time-diff}}前更新过</div>\\n        </div>\\n\\n        <div class=\\\"\\\">\\n            <!-- 这里是页面内容区 -->\\n            <div class=\\\"cookbook-box\\\" id=\\\"cookbook_{{id}}\\\">\\n                <div class=\\\"card\\\" v-for=\\\"item in cookbookItems\\\" @click=\\\"goCookbookDetail(item.id)\\\">\\n                    <div class=\\\"card-content\\\">\\n                        <div class=\\\"list-block media-list\\\">\\n                            <ul>\\n                                <li class=\\\"item-content\\\">\\n                                    <div class=\\\"item-media\\\">\\n                                        <img :src=\\\"'http://tnfs.tngou.net/img'+item.img\\\" width=\\\"44\\\">\\n                                    </div>\\n                                    <div class=\\\"item-inner\\\">\\n                                        <div class=\\\"item-title-row\\\">\\n                                            <div class=\\\"item-title\\\">{{item.name}}</div>\\n                                        </div>\\n                                        <div class=\\\"item-subtitle\\\">{{item.food}}</div>\\n                                    </div>\\n                                </li>\\n                            </ul>\\n                        </div>\\n                    </div>\\n                </div>\\n                <!-- 加载提示符 -->\\n                <div class=\\\"infinite-scroll-preloader\\\" v-if=\\\"isShowLoad\\\">\\n                    <div class=\\\"preloader\\\"></div>\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n\\n</div>\"\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tvar value = {\n\t    cookbookClasses: [],\n\t    id: 0,\n\t    page: 1,\n\t    title: '菜谱列表',\n\t    cookbookItems: [],\n\t    maxItems: -1,\n\t    updateTime: '',\n\t    valOptions: []\n\t};\n\t\n\texports.default = value;\n\n/***/ },\n/* 11 */,\n/* 12 */,\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _q = __webpack_require__(11);\n\t\n\tvar _q2 = _interopRequireDefault(_q);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction getCookbookList(id, page) {\n\t    return _q2.default.Promise(function (_success, _error) {\n\t        $.ajax({\n\t            type: 'GET',\n\t            url: 'http://apis.baidu.com/tngou/cook/list',\n\t            data: {\n\t                id: id,\n\t                page: page\n\t            },\n\t            headers: {\n\t                apikey: 'a369f43a6392605426433831e10765ec'\n\t            },\n\t            success: function success(response) {\n\t                if (response.status) {\n\t                    //拿第一页的时候保存到本地\n\t                    if (page == 1) {\n\t                        localStorage.setItem('cookbook_list_' + id, JSON.stringify({\n\t                            id: id,\n\t                            updateTime: new Date().getTime(),\n\t                            page: 2,\n\t                            cookbookItems: response.tngou,\n\t                            maxItems: response.total\n\t                        }));\n\t                    } else {\n\t                        var oldValue = JSON.parse(localStorage.getItem('cookbook_list_' + id));\n\t                        for (var i = 0; i < response.tngou.length; i++) {\n\t                            oldValue.cookbookItems.push(response.tngou[i]);\n\t                        }\n\t                        oldValue.page = ++page;\n\t                        oldValue.maxItems = response.total;\n\t                        localStorage.setItem('cookbook_list_' + id, JSON.stringify(oldValue));\n\t                    }\n\t                    _success(response);\n\t                } else {\n\t                    _error('请求失败');\n\t                }\n\t            },\n\t            error: function error(xhr) {\n\t                _error('请求失败');\n\t            }\n\t        });\n\t    });\n\t}\n\t\n\tfunction getCookbookClass() {\n\t\n\t    return _q2.default.Promise(function (_success2, _error2) {\n\t\n\t        var classes = $.localStorage.getItem('cookbook_classes');\n\t        if (classes) {\n\t            _success2(classes);\n\t        } else {\n\t            $.ajax({\n\t                type: 'GET',\n\t                url: 'http://apis.baidu.com/tngou/cook/classify',\n\t                data: {\n\t                    id: 0\n\t                },\n\t                headers: {\n\t                    apikey: 'a369f43a6392605426433831e10765ec'\n\t                },\n\t                success: function success(response) {\n\t                    if (response.status) {\n\t                        localStorage.setItem('cookbook_classes', JSON.stringify(response.tngou));\n\t                        _success2(response);\n\t                    } else {\n\t                        _error2('请求失败!');\n\t                    }\n\t                },\n\t                error: function error(xhr, errorType) {\n\t                    _error2('请求失败');\n\t                }\n\t            });\n\t        }\n\t    });\n\t}\n\t\n\tfunction getCookbookDetail(id) {\n\t    return _q2.default.Promise(function (_success3, _error3) {\n\t        $.ajax({\n\t            type: 'GET',\n\t            url: 'http://apis.baidu.com/tngou/cook/show',\n\t            data: {\n\t                id: id\n\t            },\n\t            headers: {\n\t                apikey: 'a369f43a6392605426433831e10765ec'\n\t            },\n\t            success: function success(response) {\n\t                if (response.status) {\n\t                    _success3(response);\n\t                } else {\n\t                    _error3('请求失败');\n\t                }\n\t            },\n\t            error: function error(xhr, errorType) {\n\t                _error3('请求失败');\n\t            }\n\t        });\n\t    });\n\t}\n\tvar cookbookService = {\n\t    getCookbookList: getCookbookList,\n\t    getCookbookClass: getCookbookClass,\n\t    getCookbookDetail: getCookbookDetail\n\t};\n\t\n\texports.default = cookbookService;\n\n/***/ }\n]);\n\n\n/** WEBPACK FOOTER **\n ** 1.0ce212e3.js\n **/","'use strict';\nimport Vue from 'vue'\nimport Tpl from './template.html'\nimport './style.css'\nimport value from './value'\nimport Q from 'q'\nimport cookbookService from '../../service/cookbook.service'\n\nlet Index = Vue.extend({\n    //replace : true, //必须注释掉 不然动画失效\n    template : Tpl,\n    ready : function(){ //做浏览器判断 和 兼容\n        let loading = false;\n        //$('#class_tab').attr('data-offset',$('header.bar.bar-nav')[0].offsetHeight-1)\n        //绑定无限滚动事件\n        $('.infinite-scroll-bottom').on('infinite',()=>{\n            if(loading){ return; }\n            loading = true;\n\n            cookbookService.getCookbookList(this.id,this.page).then((data)=>{\n                this.page += 1;\n                for(let i=0;i<=data.tngou.length;i++){\n                    if(data.tngou[i]){\n                        this.cookbookItems.push(data.tngou[i])\n                    }\n                }\n                if(this.maxItems == -1){\n                    this.maxItems = data.total;\n                }\n                loading = false;\n            }).catch(()=>{\n                console.error('出错啦');\n            }).finally(()=>{\n                if(!this.isShowLoad){\n                    //解绑无限加载事件\n                    $.detachInfiniteScroll($('.infinite-scroll'));\n                    // 删除加载提示符\n                    $('.infinite-scroll-preloader').remove();\n                }\n            })\n\n        });\n\n        //绑定下拉刷新事件\n        $('.pull-to-refresh-content').on('refresh',()=>{\n            if(loading){ return; }\n            loading = true;\n\n            this.page = 1;\n            cookbookService.getCookbookList(this.id,this.page).then((data)=>{\n                this.page += 1;\n                this.updateTime = new Date().getTime();\n                this.cookbookItems = data.tngou;\n                if(this.maxItems > 0){\n                    this.maxItems = data.total;\n                }\n                loading = false;\n                // 加载完毕需要重置\n                $.pullToRefreshDone('.pull-to-refresh-content');\n            }).catch(()=>{\n                console.error('出错啦');\n                //加载完毕需要重置\n                $.pullToRefreshDone('.pull-to-refresh-content');\n            })\n        });\n\n        //需要初始化一下,不然监听不到infinite事件\n        $.init();\n        \n        setTimeout(()=>{\n            this.scrollTabBtn(this.id);\n        },3e2);\n\n    },\n    data : ()=>{\n        return value\n    },\n    methods: {\n        goCookbook(id){\n            this.$router.go('/cookbook/'+id);\n            this.scrollTabBtn(id);\n        },\n        goCookbookDetail(id){\n            this.$router.go('/cookbookDetail/'+id);\n        },\n        goBack(){\n            this.$router.go('/cookbook/1');\n        },\n        goRoute(route){\n            //$.closePanel();\n            $('body').removeClass('with-panel-left-reveal');\n            //setTimeout(()=>{\n                this.$router.go(route);\n            //},5e2)\n        },\n        openPanel(panel_id){\n            $.openPanel('#'+panel_id)\n        },\n        scrollTabBtn(id){\n            let class_id = id;\n            let $el = $('.button.class_'+class_id);\n            let el = $el[0];\n            if($el.length == 0 ){\n                return;\n            }\n\n            let scrollLeft = el.offsetLeft - el.parentNode.offsetLeft;\n            let scrollLeft_active = $('#class_tab')?$('#class_tab')[0].scrollLeft:0;\n\n\n            if($.device.android && $.device.isWeixin){\n                $('#class_tab').scrollLeft(scrollLeft-50);\n            }else{\n                if(scrollLeft_active - scrollLeft < 0){\n                    for(let i=0;i<50;i++){\n                        (function(){\n                            setTimeout(()=>{\n                                $('#class_tab').scrollLeft(Math.abs(scrollLeft_active+(scrollLeft-scrollLeft_active)/50*i)-i);\n                            },5*i)\n                        })()\n                    }\n                }else{\n                    for(let i=0;i<50;i++){\n                        (function(){\n                            setTimeout(()=>{\n                                $('#class_tab').scrollLeft(scrollLeft-(scrollLeft_active-scrollLeft)/50*i-i);\n                            },5*i)\n                        })()\n                    }\n                }\n            }\n\n        }\n    },\n    computed : {\n        isShowLoad : function(){\n            return (!this.maxItems || !this.cookbookItems || this.maxItems > this.cookbookItems.length);\n        }\n    },\n    route : {\n        data : function(transition){\n            this.title = '菜谱列表';\n\n            if(typeof localStorage.getItem('cookbook_classes') == 'string'){\n                this.cookbookClasses = JSON.parse(localStorage.getItem('cookbook_classes'));\n            }\n            //如果是服务端渲染的,应该设置全局变量,那么客户端就不用异步请求数据了\n            if(window.cm_cookbookItems && window.cm_cookbookItems.id == transition.to.params.id){\n                console.log('应该只进入一次');\n                this.$data = window.cm_cookbookItems;\n                $.localStorage.setItem('cookbook_list_'+transition.to.params.id,{\n                    id : transition.to.params.id,\n                    updateTime : new Date().getTime(),\n                    page : 2,\n                    cookbookItems : window.cm_cookbookItems.cookbookItems,\n                    maxItems : window.cm_cookbookItems.maxItems\n                });\n                window.cm_cookbookItems = null;\n            }\n            let cookbook = $.localStorage.getItem('cookbook_list_'+transition.to.params.id);\n            //缓存里面还有数据\n            if(this.id == transition.to.params.id){\n                setTimeout(()=>{\n                    $('.content').scrollTop(this.scrollTop);\n                });\n            }\n            else if(cookbook && cookbook.cookbookItems.length >= 10){\n                //本地如果有数据的话拿本地数据\n                this.id = cookbook.id;\n                this.page = cookbook.page;\n                this.cookbookItems = cookbook.cookbookItems;\n                this.maxItems = cookbook.maxItems;\n                this.updateTime = cookbook.updateTime;\n\n            }\n            else{\n                $.showIndicator()\n                //没有本地数据再去请求数据\n                let qa_id = transition.to.params.id;\n\n                let promise = [\n                    cookbookService.getCookbookList(qa_id,1)\n                ];\n                if(typeof localStorage.getItem('cookbook_classes') != 'string'){\n                    promise.push(cookbookService.getCookbookClass());\n                }\n\n                Q.all(promise).then((data)=>{\n                    let data0 = data[0];\n                    if(data0.status){\n                        this.id = qa_id;\n                        this.page = 2;\n                        this.cookbookItems = data0.tngou;\n                        this.maxItems = data0.total;\n                    }else{\n                        transition.abort();\n                    }\n                    if(data.length > 1){\n                        this.cookbookClasses = data[1].tngou;\n                    }\n                }).catch((e)=>{\n                    $.toast(\"操作失败\");\n                }).finally(()=>{\n                    $.hideIndicator()\n                })\n                \n                transition.next();\n            }\n        },\n        canReuse: true, //可以被重用,跳转到其他cookbook/? 页面时触发. 设置为True跳转失败会无限跳转\n        activate : function(transition){\n            if(window.cm_cookbookItems){\n                this.cookbookClasses = window.cm_cookbookItems.cookbookClasses;\n            }\n            if(!this.cookbookClasses.length > 0){\n                cookbookService.getCookbookClass().then((data)=>{\n                    if(data.length > 0){\n                        this.cookbookClasses = data.tngou;\n                    }\n                })\n            }\n            transition.next();\n        },\n        deactivate: function(transition){\n            transition.next();\n        }\n    }\n})\n\nexport default Index\n\n\n/** WEBPACK FOOTER **\n ** ./client/com.chezhil.cookbook/states/cookbook-list/route.js\n **/","module.exports = \"<div class=\\\"page page-current\\\">\\n    <!-- 标题栏 -->\\n    <header class=\\\"bar bar-nav\\\">\\n        <h1 class=\\\"title\\\">菜谱demo</h1>\\n    </header>\\n\\n    <!--2级标题栏-->\\n    <div class=\\\"bar bar-header-secondary\\\" id=\\\"class_tab\\\">\\n        <a v-for=\\\"item in cookbookClasses\\\" @click=\\\"goCookbook(item.id)\\\"\\n           class=\\\"button class_{{item.id}} {{item.id == id?'active':''}}\\\"\\n        >{{item.title}}</a>\\n    </div>\\n\\n\\n    <div class=\\\"content infinite-scroll infinite-scroll-bottom pull-to-refresh-content\\\"  data-ptr-distance=\\\"70\\\" >\\n        <!-- 默认的下拉刷新层 -->\\n        <div class=\\\"pull-to-refresh-layer\\\">\\n            <div class=\\\"preloader\\\"></div>\\n            <div class=\\\"pull-to-refresh-arrow\\\"></div>\\n            <div style=\\\"position:absolute;bottom:-3px;width:100%;text-align: center;font-size: 12px;\\\">{{updateTime | time-diff}}前更新过</div>\\n        </div>\\n\\n        <div class=\\\"\\\">\\n            <!-- 这里是页面内容区 -->\\n            <div class=\\\"cookbook-box\\\" id=\\\"cookbook_{{id}}\\\">\\n                <div class=\\\"card\\\" v-for=\\\"item in cookbookItems\\\" @click=\\\"goCookbookDetail(item.id)\\\">\\n                    <div class=\\\"card-content\\\">\\n                        <div class=\\\"list-block media-list\\\">\\n                            <ul>\\n                                <li class=\\\"item-content\\\">\\n                                    <div class=\\\"item-media\\\">\\n                                        <img :src=\\\"'http://tnfs.tngou.net/img'+item.img\\\" width=\\\"44\\\">\\n                                    </div>\\n                                    <div class=\\\"item-inner\\\">\\n                                        <div class=\\\"item-title-row\\\">\\n                                            <div class=\\\"item-title\\\">{{item.name}}</div>\\n                                        </div>\\n                                        <div class=\\\"item-subtitle\\\">{{item.food}}</div>\\n                                    </div>\\n                                </li>\\n                            </ul>\\n                        </div>\\n                    </div>\\n                </div>\\n                <!-- 加载提示符 -->\\n                <div class=\\\"infinite-scroll-preloader\\\" v-if=\\\"isShowLoad\\\">\\n                    <div class=\\\"preloader\\\"></div>\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n\\n</div>\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/com.chezhil.cookbook/states/cookbook-list/template.html\n ** module id = 8\n ** module chunks = 1\n **/","'use strict';\nlet value = {\n    cookbookClasses : [],\n    id : 0,\n    page : 1,\n    title : '菜谱列表',\n    cookbookItems : [],\n    maxItems : -1,\n    updateTime : '',\n    valOptions : [],\n}\n\nexport default value;\n\n\n/** WEBPACK FOOTER **\n ** ./client/com.chezhil.cookbook/states/cookbook-list/value.js\n **/","'use strict';\nimport Q from 'q'\n\nfunction getCookbookList(id,page){\n    return Q.Promise((success,error)=>{\n        $.ajax({\n            type : 'GET',\n            url  : 'http://apis.baidu.com/tngou/cook/list',\n            data : {\n                id : id ,\n                page : page\n            },\n            headers : {\n                apikey : 'a369f43a6392605426433831e10765ec'\n            },\n            success : function(response){\n                if(response.status){\n                    //拿第一页的时候保存到本地\n                    if(page == 1){\n                        localStorage.setItem('cookbook_list_'+id,JSON.stringify({\n                            id : id,\n                            updateTime : new Date().getTime(),\n                            page : 2,\n                            cookbookItems : response.tngou,\n                            maxItems : response.total\n                        }));\n                    }else{\n                        let oldValue = JSON.parse(localStorage.getItem('cookbook_list_'+id));\n                        for(let i=0;i<response.tngou.length;i++){\n                            oldValue.cookbookItems.push(response.tngou[i]);\n                        }\n                        oldValue.page = ++page;\n                        oldValue.maxItems = response.total\n                        localStorage.setItem('cookbook_list_'+id,JSON.stringify(oldValue))\n                    }\n                    success(response)\n                }else{\n                    error('请求失败')\n                }\n            },\n            error : function(xhr){\n                error('请求失败')\n            }\n        });\n    })\n}\n\nfunction getCookbookClass(){\n    \n    return Q.Promise((success,error)=>{\n        \n        let classes = $.localStorage.getItem('cookbook_classes')\n        if(classes){\n            success(classes);\n        }else{\n            $.ajax({\n                type : 'GET',\n                url  : 'http://apis.baidu.com/tngou/cook/classify',\n                data : {\n                    id : 0\n                },\n                headers : {\n                    apikey : 'a369f43a6392605426433831e10765ec'\n                },\n                success : function(response){\n                    if(response.status){\n                        localStorage.setItem('cookbook_classes',JSON.stringify(response.tngou));\n                        success(response)\n                    }else{\n                        error('请求失败!')\n                    }\n                },\n                error : function(xhr, errorType){\n                    error('请求失败')\n                }\n            });\n\n        }\n       \n    })\n}\n\nfunction getCookbookDetail(id){\n    return Q.Promise((success,error)=>{\n        $.ajax({\n            type : 'GET',\n            url  : 'http://apis.baidu.com/tngou/cook/show',\n            data : {\n                id : id\n            },\n            headers : {\n                apikey : 'a369f43a6392605426433831e10765ec'\n            },\n            success : function(response){\n                if(response.status){\n                    success(response)\n                }else{\n                    error('请求失败')\n                }\n            },\n            error : function(xhr, errorType){\n                error('请求失败')\n            }\n        });\n    })\n}\nlet cookbookService = {\n    getCookbookList : getCookbookList,\n    getCookbookClass : getCookbookClass,\n    getCookbookDetail: getCookbookDetail\n};\n\nexport default cookbookService;\n\n\n/** WEBPACK FOOTER **\n ** ./client/com.chezhil.cookbook/service/cookbook.service.js\n **/"],"sourceRoot":""}